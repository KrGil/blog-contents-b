# 모평균 *μ*

> 모평균의 추정에 대해 정리해 보려고 합니다. 수업이 가면 갈수록 어려워지네요. 요즘들어 학창시절 수학 공부를 하지 않았던 저 자신이 후회되는 시간을 자주 갖는 듯 합니다. 뒤처진 만큼 꾸준히 해나가야할 듯 합니다.
>
> *국민대 인공지능수학 13주차 수업 자료를 바탕으로 작성되었습니다.*



## 모평균의 추정

- 모평균이 정규분포인 경우

  - 표본평균을 사용
    $$
    \overline{X} = \frac{X_1+X_2+\dots+X_n}{n}= \frac{\sum_{i=1}^{10}X_1}{n}
    $$

## 종류

### 1. 점추정

- 표본평균이 점 추전값 (추정량)이 됨

```python
import numpy as np
## 표본추출
samples = [9,4,0,8,1,3,7,8,4,2]
## 표본의 평균 = 모집단의 점추정 값
print(np.mean(samples))
// 4.6
```



### 2. 구간추정

- 모평균 *μ*의 100(1 - *α*)% 신뢰구간(confidence interval)
  - (μ의 추정량(점추정값)) $±Z_{α/2}$ (추정량의 표전편차)


- 정규분포에서 *σ*를 알 때
  - $(\overline{X} - Z_{a/2}\frac{σ}{\sqrt{n}}, \overline{X} + Z_{a/2}\frac{σ}{\sqrt{n}})$
  - 단점: 정규분포가 아니거나 표준편차(시그마: σ)가 알려져 있는 경우가 잘 없음
- 표본의 크기가 클 때 중심극한 정리 사용
  - (μ의 추정량(점추정값)) $±Z_{α/2}$ (추정량의 표전편차)
  - $(\overline{X} - Z_{a/2}\frac{S}{\sqrt{n}}, \overline{X} + Z_{a/2}\frac{S}{\sqrt{n}})$
  - s: 표본표준편차


#### 예제 1
> 한 학교의 남학생의 평균키를 추정하기 위해 36명의 표본으로 추출하여 평균키에 대한 95% 신뢰 구간을 구하려 한다. 표본평균이 $\overline{X}=173.6$ 이고 표본표준편차가 $s=3.6$일 때, 평균키에 대한 95% 신뢰 구간을 구하라.
>
> 
>
> 신뢰구간:  $95\% = 100(1 - α)\%$ 
>
> α = 0.05
>
> $\overline{X} = 173.6$
>
> $Z_{a/2} = Z_{0.025}$  = 1.96
>
> ​		*(1 - 0.025) = 0.975 => 정규분포표에서 0.975 찾으면 1.96이 나옴*
>
> $Z_{a/2}\frac{s}{\sqrt{n}} = 1.96*\frac{3.6}{\sqrt{36}} = 1.96 * \frac{3.6}{6} = 1.176$

**95% 신뢰 구간**

$(\overline{X} - Z_{a/2}\frac{S}{\sqrt{n}}, \overline{X} + Z_{a/2}\frac{S}{\sqrt{n}})$

$(173.6 - 1.176, 173.6 + 1.176) = (172.4, 174.8)$



**(172.4, 174.8) 의미**: 

- 36개의 표본을 100번을 뽑아 평균을 구했을 때 그 중 95번 정도는 172.4, 174.8 값 사이에 있을 것이다를 뜻합니다.

- α 값이 0.05이기 때문에 5%의 확률로 모평균이 위의 값 안에 들어가지 않는다는 것을 의미합니다.
- α 값을 더 작게 만들게 되면 신뢰구간의 간격이 벌어지게 된다는 것을 뜻합니다.



#### 예제 2

> 어떤 농장에서 생산된 계란 30 개의 표본을 뽑았더니 그 무게가 아래와 같다. 
>
> w=[10.7, 11.7, 9.8, 11.4, 10.8, 9.9, 10.1, 8.8, 12.2, 11.0, 11.3, 11.1, 10.3, 10.0, 9.9, 11.1, 11.7, 11.5, 9.1, 10.3, 8.6, 12.1, 10.0, 13.0, 9.2, 9.8, 9.3, 9.4, 9.6, 9.2] 
>
>  계란의 평균 무게에 대한 95% 신뢰 구간을 구하시오.

```python
import scipy.stats
import math

w=[10.7, 11.7, 9.8, 11.4, 10.8, 9.9, 10.1, 8.8, 12.2, 11.0, 11.3, 11.1, 10.3, 10.0, 9.9, 11.1, 11.7, 11.5, 9.1, 10.3, 8.6, 12.1, 10.0, 13.0, 9.2, 9.8, 9.3, 9.4, 9.6, 9.2] 

xbar = np.mean(w)
sd = np.std(w, ddof=1)
print('평균: %.2f, 표준편차: %.2f' %(xbar, sd))

alpha = 0.05
zalpha = scipy.stats.norm.ppf(1-alpha/2)
print('zalpha: ', zalpha)

# Z_a/2 * s/sqrt(n) 
za = zalpha * sd / math.sqrt(30)

## 95% 신뢰구간
pre = xbar - za
pos = xbar + za

print(f'95% 신뢰구간: ({pre:.3f}, {pos:.3f})')

// 평균: 10.43, 표준편차: 1.11
// zalpha:  1.959963984540054
// 95% 신뢰구간: (10.033, 10.827)
```



